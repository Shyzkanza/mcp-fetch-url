---
description: Workflow de développement et commandes pour MCP Fetch URL
globs: 
alwaysApply: false
---

# Workflow de Développement - MCP Fetch URL

## Prérequis

- **Node.js** >= 18.0.0
- **npm**
- **ngrok** (pour tests ChatGPT)

## Commandes Disponibles

### Développement

```bash
npm run dev              # Dev mode avec hot-reload
npm run dev:http         # Alias
npm run dev:tunnel       # Dev + ngrok
```

### Build

```bash
npm run build            # Compile TypeScript
npm run clean            # Supprime dist/
npm run rebuild          # Clean + build
```

### Production

```bash
npm run start            # Lance le serveur
npm run build:start      # Build puis start
```

### Utilitaires

```bash
npm run kill             # Kill le process sur le port
npm run kill:tunnel      # Kill ngrok
npm run tunnel           # Lance ngrok
npm run inspect          # MCP Inspector
npm run health           # Health check
```

## Workflow recommandé

```bash
# Terminal 1 - Tunnel ngrok
npm run tunnel

# Terminal 2 - Serveur dev
npm run dev
```

Via Cursor :
- **Cmd+Shift+P** → `tunnel-only`
- **Cmd+Shift+P** → `dev-server`

## Variables d'Environnement

```bash
PORT=3000
NODE_ENV=development
CORS_ORIGIN=*
```

## Endpoints

| Endpoint | Méthode | Description |
|----------|---------|-------------|
| `/mcp` | GET | Discovery MCP (JSON) ou Streamable HTTP |
| `/mcp` | POST | Streamable HTTP (MCP requests) |
| `/health` | GET/HEAD | Health check |

## Erreurs courantes

| Erreur | Solution |
|--------|----------|
| `EADDRINUSE` | `npm run kill` |
| `CORS error` | Vérifier `CORS_ORIGIN` |
| `Cannot find module` | Ajouter `.js` |

## Workflow Git et Releases

### Développement
- ✅ **Toujours développer sur `develop`**
- ✅ **Pas de commit direct sur `main`**
- ✅ **Développement continu sans interruption**

### Processus de Release

**⚠️ RÈGLE CRITIQUE : TOUJOURS demander la version avant de créer une MR**

1. **Décision de release** : L'utilisateur décide de faire une release
2. **❓ DEMANDER LA VERSION** : L'IA DOIT demander "Quelle version voulez-vous faire ?" (ex: "2.1.0 ?")
3. **Créer MR** : Merge Request `develop` → `main`
   - **Titre OBLIGATOIRE** : `Release X.Y.Z` (ex: `Release 2.1.0`)
   - Description : résumé des changements
4. **Validation MR** : L'utilisateur valide la MR
5. **Merge dans main** : Merge avec SQUASH + créer tag `X.Y.Z` (sans "v") + push
6. **Synchronisation** : Merge normal `main` → `develop` (SANS squash) + push

**Format des tags** :
- ❌ `v1.0.0` (avec "v")
- ✅ `1.0.0` (sans "v")
- ✅ Doit correspondre EXACTEMENT à la version dans `package.json`

Voir [WORKFLOW.md](../WORKFLOW.md) pour le schéma détaillé.
